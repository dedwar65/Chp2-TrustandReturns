---------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /Volumes/SSD PRO/Github-forks/Chp2-TrustandReturns/Notes/Logs/03_pre
> p_controls.log
  log type:  text
 opened on:  19 Feb 2026, 13:44:02

. 
. use "${CLEANED}/all_data_merged.dta", clear

. 
. * ---------------------------------------------------------------------
. * Demographics / controls (Notes ยง2: age, education, employment, marital, immig
> ration)
. * ---------------------------------------------------------------------
. * Education (time-invariant in RAND)
. capture confirm variable raedyrs

. if !_rc {
.     capture drop educ_yrs
.     gen educ_yrs = raedyrs
(649 missing values generated)
. }

. 
. * Gender (time-invariant)
. capture confirm variable ragender

. if !_rc {
.     capture drop gender
.     gen byte gender = ragender
. }

. 
. * Immigration (time-invariant; 1 = born in US)
. capture confirm variable rabplace

. if !_rc {
.     capture drop immigrant
.     gen byte immigrant = .
(45,234 missing values generated)
.     replace immigrant = 1 if inlist(rabplace,11,13)
(6,435 real changes made)
.     replace immigrant = 0 if inrange(rabplace,1,10) | rabplace == 12
(38,282 real changes made)
. }

. * Born in US (rabplace codes 1-10,12)
. capture confirm variable rabplace

. if !_rc {
.     capture drop born_us
.     gen byte born_us = .
(45,234 missing values generated)
.     replace born_us = 1 if inrange(rabplace,1,10) | rabplace == 12
(38,282 real changes made)
.     replace born_us = 0 if inlist(rabplace,11,13)
(6,435 real changes made)
. }

. 
. * Race/ethnicity (raracem + rahispan) if available
. capture confirm variable raracem

. capture confirm variable rahispan

. if !_rc {
.     capture drop race_eth
.     gen byte race_eth = .
(45,234 missing values generated)
.     replace race_eth = 3 if rahispan == 1
(5,977 real changes made)
.     replace race_eth = 1 if rahispan == 0 & raracem == 1
(28,210 real changes made)
.     replace race_eth = 2 if rahispan == 0 & raracem == 2
(8,803 real changes made)
.     replace race_eth = 4 if rahispan == 0 & raracem == 3
(1,660 real changes made)
. }

. 
. * Trust and IVs (rename to descriptive names)
. capture confirm variable rv568_2020

. if !_rc {
.     capture drop par_citizen_2020
.     gen par_citizen_2020 = rv568_2020
(44,206 missing values generated)
. }

. capture confirm variable rv569_2020

. if !_rc {
.     capture drop par_loyalty_2020
.     gen par_loyalty_2020 = rv569_2020
(44,215 missing values generated)
. }

. capture confirm variable rv570_2020

. if !_rc {
.     capture drop population_2020
.     gen population_2020 = rv570_2020
(44,120 missing values generated)
. }

. 
. * Collapsed population bins (2020): 1-2 small town, 3-4 small city, 5-6 large m
> etro
. capture confirm variable population_2020

. if !_rc {
.     capture drop population_3bin_2020
.     gen byte population_3bin_2020 = .
(45,234 missing values generated)
.     replace population_3bin_2020 = 1 if inlist(population_2020, 1, 2)
(241 real changes made)
.     replace population_3bin_2020 = 2 if inlist(population_2020, 3, 4)
(485 real changes made)
.     replace population_3bin_2020 = 3 if inlist(population_2020, 5, 6)
(388 real changes made)
. }

. 
. * Financial literacy (rename)
. capture confirm variable rv565_2020

. if !_rc {
.     capture drop interest_2020
.     gen interest_2020 = rv565_2020
(43,932 missing values generated)
. }

. capture confirm variable rv566_2020

. if !_rc {
.     capture drop inflation_2020
.     gen inflation_2020 = rv566_2020
(43,961 missing values generated)
. }

. capture confirm variable rv567_2020

. if !_rc {
.     capture drop risk_div_2020
.     gen risk_div_2020 = rv567_2020
(44,162 missing values generated)
. }

. 
. * Additional trust regression controls (2020 wave)
. capture confirm variable r15cesd

. if !_rc {
.     capture drop depression_2020
.     gen depression_2020 = r15cesd
(30,236 missing values generated)
. }

. capture confirm variable r15conde

. if !_rc {
.     capture drop health_cond_2020
.     gen health_cond_2020 = r15conde
(29,511 missing values generated)
. }

. capture confirm variable r15govmr

. if !_rc {
.     capture drop medicare_2020
.     gen medicare_2020 = r15govmr
(29,736 missing values generated)
. }

. capture confirm variable r15govmd

. if !_rc {
.     capture drop medicaid_2020
.     gen medicaid_2020 = r15govmd
(29,851 missing values generated)
. }

. capture confirm variable r15lifein

. if !_rc {
.     capture drop life_ins_2020
.     gen life_ins_2020 = r15lifein
(29,894 missing values generated)
. }

. capture confirm variable r15beqany

. if !_rc {
.     capture drop beq_any_2020
.     gen beq_any_2020 = r15beqany
(37,746 missing values generated)
. }

. capture confirm variable r15mdiv

. if !_rc {
.     capture drop num_divorce_2020
.     gen num_divorce_2020 = r15mdiv
(29,511 missing values generated)
. }

. capture confirm variable r15mwid

. if !_rc {
.     capture drop num_widow_2020
.     gen num_widow_2020 = r15mwid
(29,511 missing values generated)
. }

. 
. * Trust variables (rename to descriptive names)
. capture confirm variable rv557_2020

. if !_rc {
.     capture drop trust_others_2020
.     gen trust_others_2020 = rv557_2020
(44,334 missing values generated)
. }

. capture confirm variable rv558_2020

. if !_rc {
.     capture drop trust_social_security_2020
.     gen trust_social_security_2020 = rv558_2020
(44,221 missing values generated)
. }

. capture confirm variable rv559_2020

. if !_rc {
.     capture drop trust_medicare_2020
.     gen trust_medicare_2020 = rv559_2020
(44,205 missing values generated)
. }

. capture confirm variable rv560_2020

. if !_rc {
.     capture drop trust_banks_2020
.     gen trust_banks_2020 = rv560_2020
(44,244 missing values generated)
. }

. capture confirm variable rv561_2020

. if !_rc {
.     capture drop trust_advisors_2020
.     gen trust_advisors_2020 = rv561_2020
(44,154 missing values generated)
. }

. capture confirm variable rv562_2020

. if !_rc {
.     capture drop trust_mutual_funds_2020
.     gen trust_mutual_funds_2020 = rv562_2020
(44,162 missing values generated)
. }

. capture confirm variable rv563_2020

. if !_rc {
.     capture drop trust_insurance_2020
.     gen trust_insurance_2020 = rv563_2020
(44,087 missing values generated)
. }

. capture confirm variable rv564_2020

. if !_rc {
.     capture drop trust_media_2020
.     gen trust_media_2020 = rv564_2020
(43,999 missing values generated)
. }

. 
. * Controls for all waves (one-wave-ahead for returns)
. forvalues w = 5/16 {
  2.     local y = 1990 + (2*`w')
  3.     capture confirm variable r`w'agey_b
  4.     if !_rc {
  5.         capture drop age_`y'
  6.         gen double age_`y' = r`w'agey_b
  7.         capture drop age_bin_`y'
  8.         gen int age_bin_`y' = floor(age_`y'/5)*5 if !missing(age_`y')
  9.     }
 10.     capture confirm variable r`w'inlbrf
 11.     if !_rc {
 12.         capture drop inlbrf_`y'
 13.         gen byte inlbrf_`y' = r`w'inlbrf
 14.     }
 15.     capture confirm variable r`w'mstat
 16.     if !_rc {
 17.         capture drop married_`y'
 18.         gen byte married_`y' = (r`w'mstat == 1) if !missing(r`w'mstat)
 19.     }
 20. }
(25,656 missing values generated)
(25,656 missing values generated)
(26,142 missing values generated)
(25,676 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(27,551 missing values generated)
(27,084 missing values generated)
(25,105 missing values generated)
(25,105 missing values generated)
(25,581 missing values generated)
(25,120 missing values generated)
(26,765 missing values generated)
(26,765 missing values generated)
(27,215 missing values generated)
(26,767 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(28,478 missing values generated)
(28,019 missing values generated)
(23,200 missing values generated)
(23,200 missing values generated)
(23,868 missing values generated)
(23,206 missing values generated)
(24,680 missing values generated)
(24,680 missing values generated)
(25,213 missing values generated)
(24,696 missing values generated)
(26,487 missing values generated)
(26,487 missing values generated)
(26,968 missing values generated)
(26,506 missing values generated)
(24,322 missing values generated)
(24,322 missing values generated)
(24,737 missing values generated)
(24,354 missing values generated)
(28,088 missing values generated)
(28,088 missing values generated)
(28,370 missing values generated)
(28,114 missing values generated)
(29,511 missing values generated)
(29,511 missing values generated)
(29,755 missing values generated)
(29,549 missing values generated)
(29,378 missing values generated)
(29,378 missing values generated)
(29,642 missing values generated)
(29,418 missing values generated)

. 
. * Census region for all waves (censreg_* to avoid ambiguity with region_pop_gro
> up, regional_trust); hometown_size from censreg x population
. forvalues w = 5/16 {
  2.     local y = 1990 + (2*`w')
  3.     capture confirm variable r`w'cenreg
  4.     if !_rc {
  5.         capture drop censreg_`y'
  6.         gen byte censreg_`y' = r`w'cenreg
  7.         * Region 5 (Other) left as-is here; recoded to missing in 08 before 
> saving analysis_ready_processed.dta
.     }
  8.     capture confirm variable population_2020
  9.     if !_rc {
 10.         capture drop hometown_size_`y'
 11.         gen int hometown_size_`y' = censreg_`y' * 100 + population_2020 if !
> missing(censreg_`y') & !missing(population_2020)
 12.     }
 13. }
(25,656 missing values generated)
(44,924 missing values generated)
(27,069 missing values generated)
(44,914 missing values generated)
(25,105 missing values generated)
(44,751 missing values generated)
(26,765 missing values generated)
(44,745 missing values generated)
(28,017 missing values generated)
(44,741 missing values generated)
(23,200 missing values generated)
(44,405 missing values generated)
(24,680 missing values generated)
(44,392 missing values generated)
(26,487 missing values generated)
(44,396 missing values generated)
(24,322 missing values generated)
(44,157 missing values generated)
(28,088 missing values generated)
(44,220 missing values generated)
(29,511 missing values generated)
(44,120 missing values generated)
(32,351 missing values generated)
(44,345 missing values generated)

. 
. * Contextual trust (group avg of trust by region x town population, all waves)
. capture confirm variable population_2020

. capture confirm variable trust_others_2020

. if !_rc {
.     forvalues w = 5/16 {
  2.         local y = 1990 + (2*`w')
  3.         capture confirm variable censreg_`y'
  4.         if !_rc {
  5.             capture drop region_pop_group_`y' townsize_trust_`y'
  6.             gen int region_pop_group_`y' = censreg_`y' * 100 + population_20
> 20 if !missing(censreg_`y') & !missing(population_2020)
  7.             egen double townsize_trust_`y' = mean(trust_others_2020), by(reg
> ion_pop_group_`y')
  8.         }
  9.     }
(44,924 missing values generated)
(44,914 missing values generated)
(44,751 missing values generated)
(44,745 missing values generated)
(1 missing value generated)
(44,741 missing values generated)
(44,405 missing values generated)
(44,392 missing values generated)
(44,396 missing values generated)
(44,157 missing values generated)
(44,220 missing values generated)
(1 missing value generated)
(44,120 missing values generated)
(1 missing value generated)
(44,345 missing values generated)
(1 missing value generated)
. }

. 
. capture confirm variable population_3bin_2020

. capture confirm variable trust_others_2020

. if !_rc {
.     forvalues w = 5/16 {
  2.         local y = 1990 + (2*`w')
  3.         capture confirm variable censreg_`y'
  4.         if !_rc {
  5.             capture drop region_pop3_group_`y' townsize3_trust_`y'
  6.             gen int region_pop3_group_`y' = censreg_`y' * 10 + population_3b
> in_2020 if !missing(censreg_`y') & !missing(population_3bin_2020)
  7.             egen double townsize3_trust_`y' = mean(trust_others_2020), by(re
> gion_pop3_group_`y')
  8.         }
  9.     }
(44,924 missing values generated)
(44,914 missing values generated)
(44,751 missing values generated)
(44,745 missing values generated)
(1 missing value generated)
(44,741 missing values generated)
(44,405 missing values generated)
(44,392 missing values generated)
(44,396 missing values generated)
(44,157 missing values generated)
(44,220 missing values generated)
(44,120 missing values generated)
(44,345 missing values generated)
. }

. 
. * Contextual trust by population only (all waves)
. capture confirm variable population_2020

. capture confirm variable trust_others_2020

. if !_rc {
.     forvalues w = 5/16 {
  2.         local y = 1990 + (2*`w')
  3.         capture drop pop_trust_`y'
  4.         egen double pop_trust_`y' = mean(trust_others_2020), by(population_2
> 020)
  5.     }
. }

. 
. capture confirm variable population_3bin_2020

. capture confirm variable trust_others_2020

. if !_rc {
.     forvalues w = 5/16 {
  2.         local y = 1990 + (2*`w')
  3.         capture drop pop3_trust_`y'
  4.         egen double pop3_trust_`y' = mean(trust_others_2020), by(population_
> 3bin_2020)
  5.     }
. }

. 
. * Regional trust (group avg of trust by census region, all waves)
. capture confirm variable trust_others_2020

. if !_rc {
.     forvalues w = 5/16 {
  2.         local y = 1990 + (2*`w')
  3.         capture confirm variable censreg_`y'
  4.         if !_rc {
  5.             capture drop regional_trust_`y'
  6.             egen double regional_trust_`y' = mean(trust_others_2020), by(cen
> sreg_`y')
  7.         }
  8.     }
(29,511 missing values generated)
. }

. 
. * ---------------------------------------------------------------------
. * Wealth deciles by year (four concepts: core, ira-only, residential-only, tota
> l net wealth)
. * RAND: h5atotb (2000), h6atotb (2002), ... h16atotb (2022). Lowercase.
. * ---------------------------------------------------------------------
. local wyears "2000 2002 2004 2006 2008 2010 2012 2014 2016 2018 2020 2022"

. local watotb "h5atotb h6atotb h7atotb h8atotb h9atotb h10atotb h11atotb h12atot
> b h13atotb h14atotb h15atotb h16atotb"

. local watoth "h5atoth h6atoth h7atoth h8atoth h9atoth h10atoth h11atoth h12atot
> h h13atoth h14atoth h15atoth h16atoth"

. local wanethb "h5anethb h6anethb h7anethb h8anethb h9anethb h10anethb h11anethb
>  h12anethb h13anethb h14anethb h15anethb h16anethb"

. local waira "h5aira h6aira h7aira h8aira h9aira h10aira h11aira h12aira h13aira
>  h14aira h15aira h16aira"

. local warles "h5arles h6arles h7arles h8arles h9arles h10arles h11arles h12arle
> s h13arles h14arles h15arles h16arles"

. local wabsns "h5absns h6absns h7absns h8absns h9absns h10absns h11absns h12absn
> s h13absns h14absns h15absns h16absns"

. local wastck "h5astck h6astck h7astck h8astck h9astck h10astck h11astck h12astc
> k h13astck h14astck h15astck h16astck"

. local wabond "h5abond h6abond h7abond h8abond h9abond h10abond h11abond h12abon
> d h13abond h14abond h15abond h16abond"

. local wachck "h5achck h6achck h7achck h8achck h9achck h10achck h11achck h12achc
> k h13achck h14achck h15achck h16achck"

. local wacd "h5acd h6acd h7acd h8acd h9acd h10acd h11acd h12acd h13acd h14acd h1
> 5acd h16acd"

. local watran "h5atran h6atran h7atran h8atran h9atran h10atran h11atran h12atra
> n h13atran h14atran h15atran h16atran"

. local waothr "h5aothr h6aothr h7aothr h8aothr h9aothr h10aothr h11aothr h12aoth
> r h13aothr h14aothr h15aothr h16aothr"

. forvalues j = 1/12 {
  2.     local y : word `j' of `wyears'
  3.     local w : word `j' of `watotb'
  4.     local wpri : word `j' of `watoth'
  5.     local wsec : word `j' of `wanethb'
  6.     local wira : word `j' of `waira'
  7.     local wre : word `j' of `warles'
  8.     local wbus : word `j' of `wabsns'
  9.     local wstk : word `j' of `wastck'
 10.     local wbond : word `j' of `wabond'
 11.     local wchck : word `j' of `wachck'
 12.     local wcd : word `j' of `wacd'
 13.     local wtran : word `j' of `watran'
 14.     local woth : word `j' of `waothr'
 15.     capture confirm variable `w'
 16.     capture confirm variable `wpri'
 17.     capture confirm variable `wsec'
 18.     capture confirm variable `wira'
 19.     if !_rc {
 20.         local has_core 1
 21.         foreach v in `wre' `wbus' `wstk' `wbond' `wchck' `wcd' {
 22.             capture confirm variable `v'
 23.             if _rc local has_core 0
 24.         }
 25.         * Total net wealth (constructed from components, allow partial nonmi
> ssing)
.         capture drop wealth_total_`y'
 26.         capture drop gross_wealth_`y'
 27.         capture drop _gross_n_`y'
 28.         capture drop _debt_total_`y'
 29.         capture drop _debt_n_`y'
 30.         capture drop wealth_decile_`y'
 31.         egen byte _gross_n_`y' = rownonmiss(`wre' `wbus' `wstk' `wbond' `wch
> ck' `wcd' `wpri' `wsec' `wira' `wtran' `woth')
 32.         egen double _debt_total_`y' = rowtotal(h`j'amort h`j'ahmln h`j'adebt
> ), missing
 33.         egen byte _debt_n_`y' = rownonmiss(h`j'amort h`j'ahmln h`j'adebt)
 34.         gen double gross_wealth_`y' = ///
>             cond(missing(`wre'), 0, max(`wre', 0)) + cond(missing(`wbus'), 0, m
> ax(`wbus', 0)) + ///
>             cond(missing(`wstk'), 0, max(`wstk', 0)) + cond(missing(`wbond'), 0
> , max(`wbond', 0)) + ///
>             cond(missing(`wchck'), 0, max(`wchck', 0)) + cond(missing(`wcd'), 0
> , max(`wcd', 0)) + ///
>             cond(missing(`wpri'), 0, max(`wpri', 0)) + cond(missing(`wsec'), 0,
>  max(`wsec', 0)) + ///
>             cond(missing(`wira'), 0, max(`wira', 0)) + cond(missing(`wtran'), 0
> , max(`wtran', 0)) + ///
>             cond(missing(`woth'), 0, max(`woth', 0))
 35.         replace gross_wealth_`y' = . if _gross_n_`y' == 0
 36.         gen double wealth_total_`y' = gross_wealth_`y' - _debt_total_`y'
 37.         replace wealth_total_`y' = . if _gross_n_`y' == 0 & _debt_n_`y' == 0
 38. 
.         capture drop wealth_decile_`y'
 39.         xtile wealth_decile_`y' = wealth_total_`y', nq(10)
 40.         replace wealth_decile_`y' = . if missing(wealth_total_`y')
 41.         forvalues d = 1/10 {
 42.             capture drop wealth_d`d'_`y'
 43.             gen byte wealth_d`d'_`y' = wealth_decile_`y' == `d' if !missing(
> wealth_decile_`y')
 44.         }
 45. 
.         * Core wealth (exclude residences and IRA)
.         if `has_core' {
 46.             capture drop wealth_core_`y'
 47.             capture drop wealth_core_decile_`y'
 48.             gen double wealth_core_`y' = `wre' + `wbus' + `wstk' + `wbond' +
>  `wchck' + `wcd' if !missing(`wre') & !missing(`wbus') & !missing(`wstk') & !mi
> ssing(`wbond') & !missing(`wchck') & !missing(`wcd')
 49.             capture drop wealth_core_decile_`y'
 50.             xtile wealth_core_decile_`y' = wealth_core_`y', nq(10)
 51.             replace wealth_core_decile_`y' = . if missing(wealth_core_`y')
 52.             forvalues d = 1/10 {
 53.                 capture drop wealth_core_d`d'_`y'
 54.                 gen byte wealth_core_d`d'_`y' = wealth_core_decile_`y' == `d
> ' if !missing(wealth_core_decile_`y')
 55.             }
 56.         }
 57. 
.         * IRA-only wealth
.         capture drop wealth_ira_`y'
 58.         capture drop wealth_ira_decile_`y'
 59.         gen double wealth_ira_`y' = `wira' if !missing(`wira')
 60.         capture drop wealth_ira_decile_`y'
 61.         xtile wealth_ira_decile_`y' = wealth_ira_`y', nq(10)
 62.         replace wealth_ira_decile_`y' = . if missing(wealth_ira_`y')
 63.         forvalues d = 1/10 {
 64.             capture drop wealth_ira_d`d'_`y'
 65.             gen byte wealth_ira_d`d'_`y' = wealth_ira_decile_`y' == `d' if !
> missing(wealth_ira_decile_`y')
 66.         }
 67. 
.         * Core+ret. wealth (core + IRA; same scope as r4)
.         if `has_core' {
 68.             capture drop wealth_coreira_`y'
 69.             capture drop wealth_coreira_decile_`y'
 70.             gen double wealth_coreira_`y' = wealth_core_`y' + wealth_ira_`y'
>  if !missing(wealth_core_`y') & !missing(wealth_ira_`y')
 71.             capture drop wealth_coreira_decile_`y'
 72.             xtile wealth_coreira_decile_`y' = wealth_coreira_`y', nq(10)
 73.             replace wealth_coreira_decile_`y' = . if missing(wealth_coreira_
> `y')
 74.             forvalues d = 1/10 {
 75.                 capture drop wealth_coreira_d`d'_`y'
 76.                 gen byte wealth_coreira_d`d'_`y' = wealth_coreira_decile_`y'
>  == `d' if !missing(wealth_coreira_decile_`y')
 77.             }
 78.         }
 79. 
.         * Residential-only wealth (primary + secondary)
.         capture drop wealth_res_`y'
 80.         capture drop wealth_res_decile_`y'
 81.         gen double wealth_res_`y' = `wpri' + `wsec' if !missing(`wpri') & !m
> issing(`wsec')
 82.         capture drop wealth_res_decile_`y'
 83.         xtile wealth_res_decile_`y' = wealth_res_`y', nq(10)
 84.         replace wealth_res_decile_`y' = . if missing(wealth_res_`y')
 85.         forvalues d = 1/10 {
 86.             capture drop wealth_res_d`d'_`y'
 87.             gen byte wealth_res_d`d'_`y' = wealth_res_decile_`y' == `d' if !
> missing(wealth_res_decile_`y')
 88.         }
 89.     }
 90. }
(32,582 missing values generated)
(25,656 real changes made, 25,656 to missing)
(35,604 missing values generated)
(0 real changes made)
(0 real changes made)
(35,604 missing values generated)
(35,604 missing values generated)
(35,604 missing values generated)
(35,604 missing values generated)
(35,604 missing values generated)
(35,604 missing values generated)
(35,604 missing values generated)
(35,604 missing values generated)
(35,604 missing values generated)
(35,604 missing values generated)
(25,657 missing values generated)
(0 real changes made)
(25,657 missing values generated)
(25,657 missing values generated)
(25,657 missing values generated)
(25,657 missing values generated)
(25,657 missing values generated)
(25,657 missing values generated)
(25,657 missing values generated)
(25,657 missing values generated)
(25,657 missing values generated)
(25,657 missing values generated)
(25,656 missing values generated)
(0 real changes made)
(25,656 missing values generated)
(25,656 missing values generated)
(25,656 missing values generated)
(25,656 missing values generated)
(25,656 missing values generated)
(25,656 missing values generated)
(25,656 missing values generated)
(25,656 missing values generated)
(25,656 missing values generated)
(25,656 missing values generated)
(25,657 missing values generated)
(0 real changes made)
(25,657 missing values generated)
(25,657 missing values generated)
(25,657 missing values generated)
(25,657 missing values generated)
(25,657 missing values generated)
(25,657 missing values generated)
(25,657 missing values generated)
(25,657 missing values generated)
(25,657 missing values generated)
(25,657 missing values generated)
(25,656 missing values generated)
(0 real changes made)
(25,656 missing values generated)
(25,656 missing values generated)
(25,656 missing values generated)
(25,656 missing values generated)
(25,656 missing values generated)
(25,656 missing values generated)
(25,656 missing values generated)
(25,656 missing values generated)
(25,656 missing values generated)
(25,656 missing values generated)
(25,592 missing values generated)
(27,069 real changes made, 27,069 to missing)
(32,392 missing values generated)
(0 real changes made)
(0 real changes made)
(32,392 missing values generated)
(32,392 missing values generated)
(32,392 missing values generated)
(32,392 missing values generated)
(32,392 missing values generated)
(32,392 missing values generated)
(32,392 missing values generated)
(32,392 missing values generated)
(32,392 missing values generated)
(32,392 missing values generated)
(27,069 missing values generated)
(0 real changes made)
(27,069 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(0 real changes made)
(27,069 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(0 real changes made)
(27,069 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(0 real changes made)
(27,069 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(27,243 missing values generated)
(25,105 real changes made, 25,105 to missing)
(33,551 missing values generated)
(0 real changes made)
(0 real changes made)
(33,551 missing values generated)
(33,551 missing values generated)
(33,551 missing values generated)
(33,551 missing values generated)
(33,551 missing values generated)
(33,551 missing values generated)
(33,551 missing values generated)
(33,551 missing values generated)
(33,551 missing values generated)
(33,551 missing values generated)
(25,113 missing values generated)
(0 real changes made)
(25,113 missing values generated)
(25,113 missing values generated)
(25,113 missing values generated)
(25,113 missing values generated)
(25,113 missing values generated)
(25,113 missing values generated)
(25,113 missing values generated)
(25,113 missing values generated)
(25,113 missing values generated)
(25,113 missing values generated)
(25,105 missing values generated)
(0 real changes made)
(25,105 missing values generated)
(25,105 missing values generated)
(25,105 missing values generated)
(25,105 missing values generated)
(25,105 missing values generated)
(25,105 missing values generated)
(25,105 missing values generated)
(25,105 missing values generated)
(25,105 missing values generated)
(25,105 missing values generated)
(25,113 missing values generated)
(0 real changes made)
(25,113 missing values generated)
(25,113 missing values generated)
(25,113 missing values generated)
(25,113 missing values generated)
(25,113 missing values generated)
(25,113 missing values generated)
(25,113 missing values generated)
(25,113 missing values generated)
(25,113 missing values generated)
(25,113 missing values generated)
(25,105 missing values generated)
(0 real changes made)
(25,105 missing values generated)
(25,105 missing values generated)
(25,105 missing values generated)
(25,105 missing values generated)
(25,105 missing values generated)
(25,105 missing values generated)
(25,105 missing values generated)
(25,105 missing values generated)
(25,105 missing values generated)
(25,105 missing values generated)
(23,850 missing values generated)
(26,765 real changes made, 26,765 to missing)
(30,898 missing values generated)
(0 real changes made)
(0 real changes made)
(30,898 missing values generated)
(30,898 missing values generated)
(30,898 missing values generated)
(30,898 missing values generated)
(30,898 missing values generated)
(30,898 missing values generated)
(30,898 missing values generated)
(30,898 missing values generated)
(30,898 missing values generated)
(30,898 missing values generated)
(26,769 missing values generated)
(0 real changes made)
(26,769 missing values generated)
(26,769 missing values generated)
(26,769 missing values generated)
(26,769 missing values generated)
(26,769 missing values generated)
(26,769 missing values generated)
(26,769 missing values generated)
(26,769 missing values generated)
(26,769 missing values generated)
(26,769 missing values generated)
(26,765 missing values generated)
(0 real changes made)
(26,765 missing values generated)
(26,765 missing values generated)
(26,765 missing values generated)
(26,765 missing values generated)
(26,765 missing values generated)
(26,765 missing values generated)
(26,765 missing values generated)
(26,765 missing values generated)
(26,765 missing values generated)
(26,765 missing values generated)
(26,769 missing values generated)
(0 real changes made)
(26,769 missing values generated)
(26,769 missing values generated)
(26,769 missing values generated)
(26,769 missing values generated)
(26,769 missing values generated)
(26,769 missing values generated)
(26,769 missing values generated)
(26,769 missing values generated)
(26,769 missing values generated)
(26,769 missing values generated)
(26,765 missing values generated)
(0 real changes made)
(26,765 missing values generated)
(26,765 missing values generated)
(26,765 missing values generated)
(26,765 missing values generated)
(26,765 missing values generated)
(26,765 missing values generated)
(26,765 missing values generated)
(26,765 missing values generated)
(26,765 missing values generated)
(26,765 missing values generated)
(25,656 missing values generated)
(28,017 real changes made, 28,017 to missing)
(32,073 missing values generated)
(0 real changes made)
(0 real changes made)
(32,073 missing values generated)
(32,073 missing values generated)
(32,073 missing values generated)
(32,073 missing values generated)
(32,073 missing values generated)
(32,073 missing values generated)
(32,073 missing values generated)
(32,073 missing values generated)
(32,073 missing values generated)
(32,073 missing values generated)
(28,017 missing values generated)
(0 real changes made)
(28,017 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(0 real changes made)
(28,017 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(0 real changes made)
(28,017 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(0 real changes made)
(28,017 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(27,069 missing values generated)
(23,200 real changes made, 23,200 to missing)
(33,303 missing values generated)
(0 real changes made)
(0 real changes made)
(33,303 missing values generated)
(33,303 missing values generated)
(33,303 missing values generated)
(33,303 missing values generated)
(33,303 missing values generated)
(33,303 missing values generated)
(33,303 missing values generated)
(33,303 missing values generated)
(33,303 missing values generated)
(33,303 missing values generated)
(23,206 missing values generated)
(0 real changes made)
(23,206 missing values generated)
(23,206 missing values generated)
(23,206 missing values generated)
(23,206 missing values generated)
(23,206 missing values generated)
(23,206 missing values generated)
(23,206 missing values generated)
(23,206 missing values generated)
(23,206 missing values generated)
(23,206 missing values generated)
(23,201 missing values generated)
(0 real changes made)
(23,201 missing values generated)
(23,201 missing values generated)
(23,201 missing values generated)
(23,201 missing values generated)
(23,201 missing values generated)
(23,201 missing values generated)
(23,201 missing values generated)
(23,201 missing values generated)
(23,201 missing values generated)
(23,201 missing values generated)
(23,207 missing values generated)
(0 real changes made)
(23,207 missing values generated)
(23,207 missing values generated)
(23,207 missing values generated)
(23,207 missing values generated)
(23,207 missing values generated)
(23,207 missing values generated)
(23,207 missing values generated)
(23,207 missing values generated)
(23,207 missing values generated)
(23,207 missing values generated)
(23,200 missing values generated)
(0 real changes made)
(23,200 missing values generated)
(23,200 missing values generated)
(23,200 missing values generated)
(23,200 missing values generated)
(23,200 missing values generated)
(23,200 missing values generated)
(23,200 missing values generated)
(23,200 missing values generated)
(23,200 missing values generated)
(23,200 missing values generated)
(25,105 missing values generated)
(24,680 real changes made, 24,680 to missing)
(31,670 missing values generated)
(0 real changes made)
(0 real changes made)
(31,670 missing values generated)
(31,670 missing values generated)
(31,670 missing values generated)
(31,670 missing values generated)
(31,670 missing values generated)
(31,670 missing values generated)
(31,670 missing values generated)
(31,670 missing values generated)
(31,670 missing values generated)
(31,670 missing values generated)
(24,682 missing values generated)
(0 real changes made)
(24,682 missing values generated)
(24,682 missing values generated)
(24,682 missing values generated)
(24,682 missing values generated)
(24,682 missing values generated)
(24,682 missing values generated)
(24,682 missing values generated)
(24,682 missing values generated)
(24,682 missing values generated)
(24,682 missing values generated)
(24,680 missing values generated)
(0 real changes made)
(24,680 missing values generated)
(24,680 missing values generated)
(24,680 missing values generated)
(24,680 missing values generated)
(24,680 missing values generated)
(24,680 missing values generated)
(24,680 missing values generated)
(24,680 missing values generated)
(24,680 missing values generated)
(24,680 missing values generated)
(24,682 missing values generated)
(0 real changes made)
(24,682 missing values generated)
(24,682 missing values generated)
(24,682 missing values generated)
(24,682 missing values generated)
(24,682 missing values generated)
(24,682 missing values generated)
(24,682 missing values generated)
(24,682 missing values generated)
(24,682 missing values generated)
(24,682 missing values generated)
(24,681 missing values generated)
(0 real changes made)
(24,681 missing values generated)
(24,681 missing values generated)
(24,681 missing values generated)
(24,681 missing values generated)
(24,681 missing values generated)
(24,681 missing values generated)
(24,681 missing values generated)
(24,681 missing values generated)
(24,681 missing values generated)
(24,681 missing values generated)
(26,765 missing values generated)
(26,487 real changes made, 26,487 to missing)
(33,180 missing values generated)
(0 real changes made)
(0 real changes made)
(33,180 missing values generated)
(33,180 missing values generated)
(33,180 missing values generated)
(33,180 missing values generated)
(33,180 missing values generated)
(33,180 missing values generated)
(33,180 missing values generated)
(33,180 missing values generated)
(33,180 missing values generated)
(33,180 missing values generated)
(26,488 missing values generated)
(0 real changes made)
(26,488 missing values generated)
(26,488 missing values generated)
(26,488 missing values generated)
(26,488 missing values generated)
(26,488 missing values generated)
(26,488 missing values generated)
(26,488 missing values generated)
(26,488 missing values generated)
(26,488 missing values generated)
(26,488 missing values generated)
(26,488 missing values generated)
(0 real changes made)
(26,488 missing values generated)
(26,488 missing values generated)
(26,488 missing values generated)
(26,488 missing values generated)
(26,488 missing values generated)
(26,488 missing values generated)
(26,488 missing values generated)
(26,488 missing values generated)
(26,488 missing values generated)
(26,488 missing values generated)
(26,489 missing values generated)
(0 real changes made)
(26,489 missing values generated)
(26,489 missing values generated)
(26,489 missing values generated)
(26,489 missing values generated)
(26,489 missing values generated)
(26,489 missing values generated)
(26,489 missing values generated)
(26,489 missing values generated)
(26,489 missing values generated)
(26,489 missing values generated)
(26,488 missing values generated)
(0 real changes made)
(26,488 missing values generated)
(26,488 missing values generated)
(26,488 missing values generated)
(26,488 missing values generated)
(26,488 missing values generated)
(26,488 missing values generated)
(26,488 missing values generated)
(26,488 missing values generated)
(26,488 missing values generated)
(26,488 missing values generated)
(28,017 missing values generated)
(24,322 real changes made, 24,322 to missing)
(34,757 missing values generated)
(0 real changes made)
(0 real changes made)
(34,757 missing values generated)
(34,757 missing values generated)
(34,757 missing values generated)
(34,757 missing values generated)
(34,757 missing values generated)
(34,757 missing values generated)
(34,757 missing values generated)
(34,757 missing values generated)
(34,757 missing values generated)
(34,757 missing values generated)
(24,326 missing values generated)
(0 real changes made)
(24,326 missing values generated)
(24,326 missing values generated)
(24,326 missing values generated)
(24,326 missing values generated)
(24,326 missing values generated)
(24,326 missing values generated)
(24,326 missing values generated)
(24,326 missing values generated)
(24,326 missing values generated)
(24,326 missing values generated)
(24,322 missing values generated)
(0 real changes made)
(24,322 missing values generated)
(24,322 missing values generated)
(24,322 missing values generated)
(24,322 missing values generated)
(24,322 missing values generated)
(24,322 missing values generated)
(24,322 missing values generated)
(24,322 missing values generated)
(24,322 missing values generated)
(24,322 missing values generated)
(24,326 missing values generated)
(0 real changes made)
(24,326 missing values generated)
(24,326 missing values generated)
(24,326 missing values generated)
(24,326 missing values generated)
(24,326 missing values generated)
(24,326 missing values generated)
(24,326 missing values generated)
(24,326 missing values generated)
(24,326 missing values generated)
(24,326 missing values generated)
(24,322 missing values generated)
(0 real changes made)
(24,322 missing values generated)
(24,322 missing values generated)
(24,322 missing values generated)
(24,322 missing values generated)
(24,322 missing values generated)
(24,322 missing values generated)
(24,322 missing values generated)
(24,322 missing values generated)
(24,322 missing values generated)
(24,322 missing values generated)
(23,200 missing values generated)
(28,088 real changes made, 28,088 to missing)
(32,432 missing values generated)
(0 real changes made)
(0 real changes made)
(32,432 missing values generated)
(32,432 missing values generated)
(32,432 missing values generated)
(32,432 missing values generated)
(32,432 missing values generated)
(32,432 missing values generated)
(32,432 missing values generated)
(32,432 missing values generated)
(32,432 missing values generated)
(32,432 missing values generated)
(28,091 missing values generated)
(0 real changes made)
(28,091 missing values generated)
(28,091 missing values generated)
(28,091 missing values generated)
(28,091 missing values generated)
(28,091 missing values generated)
(28,091 missing values generated)
(28,091 missing values generated)
(28,091 missing values generated)
(28,091 missing values generated)
(28,091 missing values generated)
(28,088 missing values generated)
(0 real changes made)
(28,088 missing values generated)
(28,088 missing values generated)
(28,088 missing values generated)
(28,088 missing values generated)
(28,088 missing values generated)
(28,088 missing values generated)
(28,088 missing values generated)
(28,088 missing values generated)
(28,088 missing values generated)
(28,088 missing values generated)
(28,091 missing values generated)
(0 real changes made)
(28,091 missing values generated)
(28,091 missing values generated)
(28,091 missing values generated)
(28,091 missing values generated)
(28,091 missing values generated)
(28,091 missing values generated)
(28,091 missing values generated)
(28,091 missing values generated)
(28,091 missing values generated)
(28,091 missing values generated)
(28,088 missing values generated)
(0 real changes made)
(28,088 missing values generated)
(28,088 missing values generated)
(28,088 missing values generated)
(28,088 missing values generated)
(28,088 missing values generated)
(28,088 missing values generated)
(28,088 missing values generated)
(28,088 missing values generated)
(28,088 missing values generated)
(28,088 missing values generated)
(24,680 missing values generated)
(29,511 real changes made, 29,511 to missing)
(33,414 missing values generated)
(0 real changes made)
(0 real changes made)
(33,414 missing values generated)
(33,414 missing values generated)
(33,414 missing values generated)
(33,414 missing values generated)
(33,414 missing values generated)
(33,414 missing values generated)
(33,414 missing values generated)
(33,414 missing values generated)
(33,414 missing values generated)
(33,414 missing values generated)
(29,512 missing values generated)
(0 real changes made)
(29,512 missing values generated)
(29,512 missing values generated)
(29,512 missing values generated)
(29,512 missing values generated)
(29,512 missing values generated)
(29,512 missing values generated)
(29,512 missing values generated)
(29,512 missing values generated)
(29,512 missing values generated)
(29,512 missing values generated)
(29,511 missing values generated)
(0 real changes made)
(29,511 missing values generated)
(29,511 missing values generated)
(29,511 missing values generated)
(29,511 missing values generated)
(29,511 missing values generated)
(29,511 missing values generated)
(29,511 missing values generated)
(29,511 missing values generated)
(29,511 missing values generated)
(29,511 missing values generated)
(29,512 missing values generated)
(0 real changes made)
(29,512 missing values generated)
(29,512 missing values generated)
(29,512 missing values generated)
(29,512 missing values generated)
(29,512 missing values generated)
(29,512 missing values generated)
(29,512 missing values generated)
(29,512 missing values generated)
(29,512 missing values generated)
(29,512 missing values generated)
(29,511 missing values generated)
(0 real changes made)
(29,511 missing values generated)
(29,511 missing values generated)
(29,511 missing values generated)
(29,511 missing values generated)
(29,511 missing values generated)
(29,511 missing values generated)
(29,511 missing values generated)
(29,511 missing values generated)
(29,511 missing values generated)
(29,511 missing values generated)
(26,487 missing values generated)
(29,378 real changes made, 29,378 to missing)
(35,396 missing values generated)
(0 real changes made)
(0 real changes made)
(35,396 missing values generated)
(35,396 missing values generated)
(35,396 missing values generated)
(35,396 missing values generated)
(35,396 missing values generated)
(35,396 missing values generated)
(35,396 missing values generated)
(35,396 missing values generated)
(35,396 missing values generated)
(35,396 missing values generated)
(29,384 missing values generated)
(0 real changes made)
(29,384 missing values generated)
(29,384 missing values generated)
(29,384 missing values generated)
(29,384 missing values generated)
(29,384 missing values generated)
(29,384 missing values generated)
(29,384 missing values generated)
(29,384 missing values generated)
(29,384 missing values generated)
(29,384 missing values generated)
(29,378 missing values generated)
(0 real changes made)
(29,378 missing values generated)
(29,378 missing values generated)
(29,378 missing values generated)
(29,378 missing values generated)
(29,378 missing values generated)
(29,378 missing values generated)
(29,378 missing values generated)
(29,378 missing values generated)
(29,378 missing values generated)
(29,378 missing values generated)
(29,384 missing values generated)
(0 real changes made)
(29,384 missing values generated)
(29,384 missing values generated)
(29,384 missing values generated)
(29,384 missing values generated)
(29,384 missing values generated)
(29,384 missing values generated)
(29,384 missing values generated)
(29,384 missing values generated)
(29,384 missing values generated)
(29,384 missing values generated)
(29,378 missing values generated)
(0 real changes made)
(29,378 missing values generated)
(29,378 missing values generated)
(29,378 missing values generated)
(29,378 missing values generated)
(29,378 missing values generated)
(29,378 missing values generated)
(29,378 missing values generated)
(29,378 missing values generated)
(29,378 missing values generated)
(29,378 missing values generated)

. 
. * Asset shares: component / gross_assets (decoupled from m1-m5)
. * r1-r5: returns to core, retirement, residential, core+IRA, net wealth
. * m1-m5: wealth_core, wealth_res, wealth_ira, wealth_coreira, wealth_total (por
> tfolios)
. * gross_min = 500: avoid tiny denominators (debt/gross explodes when gross=1 et
> c.)
. local gross_min 500

. forvalues j = 5/16 {
  2.     local y = 1990 + (2*`j')  // wave 5=2000, 16=2022
  3.     capture drop share_pri_res_`y' share_sec_res_`y' share_res_`y' share_re_
> `y' share_bus_`y' share_ira_`y' share_stk_`y' share_bond_`y' share_chck_`y' sha
> re_other_`y' share_core_`y' share_fin_`y' share_debt_long_`y' share_debt_other_
> `y' share_debt_amort_`y' share_debt_ahmln_`y'
  4.     capture drop gross_wealth_`y'
  5.     capture drop h`j'atoth_pos h`j'anethb_pos h`j'arles_pos h`j'atran_pos h`
> j'absns_pos h`j'aira_pos h`j'astck_pos h`j'achck_pos h`j'acd_pos h`j'abond_pos 
> h`j'aothr_pos
  6.     capture confirm variable h`j'atotb
  7.     if !_rc {
  8.         * Nonnegative components for gross assets
.         gen double h`j'atoth_pos = cond(missing(h`j'atoth), ., max(h`j'atoth, 0
> ))
  9.         gen double h`j'anethb_pos = cond(missing(h`j'anethb), ., max(h`j'ane
> thb, 0))
 10.         gen double h`j'arles_pos = cond(missing(h`j'arles), ., max(h`j'arles
> , 0))
 11.         gen double h`j'atran_pos = cond(missing(h`j'atran), ., max(h`j'atran
> , 0))
 12.         gen double h`j'absns_pos = cond(missing(h`j'absns), ., max(h`j'absns
> , 0))
 13.         gen double h`j'aira_pos = cond(missing(h`j'aira), ., max(h`j'aira, 0
> ))
 14.         gen double h`j'astck_pos = cond(missing(h`j'astck), ., max(h`j'astck
> , 0))
 15.         gen double h`j'achck_pos = cond(missing(h`j'achck), ., max(h`j'achck
> , 0))
 16.         gen double h`j'acd_pos = cond(missing(h`j'acd), ., max(h`j'acd, 0))
 17.         gen double h`j'abond_pos = cond(missing(h`j'abond), ., max(h`j'abond
> , 0))
 18.         gen double h`j'aothr_pos = cond(missing(h`j'aothr), ., max(h`j'aothr
> , 0))
 19. 
.         egen double gross_wealth_`y' = rowtotal(h`j'atoth_pos h`j'anethb_pos h`
> j'arles_pos h`j'atran_pos h`j'absns_pos h`j'aira_pos h`j'astck_pos h`j'achck_po
> s h`j'acd_pos h`j'abond_pos h`j'aothr_pos)
 20.         replace gross_wealth_`y' = . if gross_wealth_`y' == 0
 21. 
.         * Component shares (all / gross_assets; gross >= gross_min to avoid tin
> y denominators)
.         gen double share_pri_res_`y' = h`j'atoth_pos / gross_wealth_`y' if !mis
> sing(h`j'atoth_pos) & !missing(gross_wealth_`y') & gross_wealth_`y' >= `gross_m
> in'
 22.         gen double share_sec_res_`y' = h`j'anethb_pos / gross_wealth_`y' if 
> !missing(h`j'anethb_pos) & !missing(gross_wealth_`y') & gross_wealth_`y' >= `gr
> oss_min'
 23.         gen double share_res_`y' = (h`j'atoth_pos + h`j'anethb_pos) / gross_
> wealth_`y' if !missing(gross_wealth_`y') & gross_wealth_`y' >= `gross_min'
 24.         gen double share_re_`y' = h`j'arles_pos / gross_wealth_`y' if !missi
> ng(h`j'arles_pos) & !missing(gross_wealth_`y') & gross_wealth_`y' >= `gross_min
> '
 25.         gen double share_bus_`y' = h`j'absns_pos / gross_wealth_`y' if !miss
> ing(h`j'absns_pos) & !missing(gross_wealth_`y') & gross_wealth_`y' >= `gross_mi
> n'
 26.         gen double share_ira_`y' = h`j'aira_pos / gross_wealth_`y' if !missi
> ng(h`j'aira_pos) & !missing(gross_wealth_`y') & gross_wealth_`y' >= `gross_min'
 27.         gen double share_stk_`y' = h`j'astck_pos / gross_wealth_`y' if !miss
> ing(h`j'astck_pos) & !missing(gross_wealth_`y') & gross_wealth_`y' >= `gross_mi
> n'
 28.         gen double share_bond_`y' = h`j'abond_pos / gross_wealth_`y' if !mis
> sing(h`j'abond_pos) & !missing(gross_wealth_`y') & gross_wealth_`y' >= `gross_m
> in'
 29.         gen double share_chck_`y' = h`j'achck_pos / gross_wealth_`y' if !mis
> sing(h`j'achck_pos) & !missing(gross_wealth_`y') & gross_wealth_`y' >= `gross_m
> in'
 30.         gen double share_other_`y' = (h`j'acd_pos + h`j'atran_pos + h`j'aoth
> r_pos) / gross_wealth_`y' if !missing(gross_wealth_`y') & gross_wealth_`y' >= `
> gross_min'
 31.         gen double share_core_`y' = (h`j'arles_pos + h`j'absns_pos + h`j'ast
> ck_pos + h`j'abond_pos + h`j'achck_pos + h`j'acd_pos) / gross_wealth_`y' if !mi
> ssing(gross_wealth_`y') & gross_wealth_`y' >= `gross_min'
 32.         * share_fin = stk+bond+chck+cd; missing only if all four missing (am
> rtb excluded from debt)
.         gen double _fin_sum_`y' = cond(missing(h`j'astck_pos),0,max(h`j'astck_p
> os,0)) + cond(missing(h`j'abond_pos),0,max(h`j'abond_pos,0)) + cond(missing(h`j
> 'achck_pos),0,max(h`j'achck_pos,0)) + cond(missing(h`j'acd_pos),0,max(h`j'acd_p
> os,0))
 33.         gen byte _fin_allmiss_`y' = missing(h`j'astck_pos) & missing(h`j'abo
> nd_pos) & missing(h`j'achck_pos) & missing(h`j'acd_pos)
 34.         gen double share_fin_`y' = _fin_sum_`y' / gross_wealth_`y' if !_fin_
> allmiss_`y' & !missing(gross_wealth_`y') & gross_wealth_`y' >= `gross_min'
 35.         drop _fin_sum_`y' _fin_allmiss_`y'
 36. 
.         * Debt shares (gross assets base; long = amort+ahmln only, no amrtb; gr
> oss >= gross_min)
.         gen double share_debt_amort_`y' = cond(missing(h`j'amort), 0, max(h`j'a
> mort, 0)) / gross_wealth_`y' if !missing(gross_wealth_`y') & gross_wealth_`y' >
> = `gross_min'
 37.         replace share_debt_amort_`y' = . if missing(h`j'amort)
 38.         gen double share_debt_ahmln_`y' = cond(missing(h`j'ahmln), 0, max(h`
> j'ahmln, 0)) / gross_wealth_`y' if !missing(gross_wealth_`y') & gross_wealth_`y
> ' >= `gross_min'
 39.         replace share_debt_ahmln_`y' = . if missing(h`j'ahmln)
 40.         gen double share_debt_long_`y' = (cond(missing(h`j'amort), 0, max(h`
> j'amort, 0)) + cond(missing(h`j'ahmln), 0, max(h`j'ahmln, 0))) / gross_wealth_`
> y' if !missing(gross_wealth_`y') & gross_wealth_`y' >= `gross_min'
 41.         replace share_debt_long_`y' = . if missing(h`j'amort) & missing(h`j'
> ahmln)
 42.         gen double share_debt_other_`y' = max(h`j'adebt, 0) / gross_wealth_`
> y' if !missing(h`j'adebt) & !missing(gross_wealth_`y') & gross_wealth_`y' >= `g
> ross_min'
 43. 
.         drop h`j'atoth_pos h`j'anethb_pos h`j'arles_pos h`j'atran_pos h`j'absns
> _pos h`j'aira_pos h`j'astck_pos h`j'achck_pos h`j'acd_pos h`j'abond_pos h`j'aot
> hr_pos
 44.     }
 45. }
(25,656 missing values generated)
(25,656 missing values generated)
(25,656 missing values generated)
(25,656 missing values generated)
(25,656 missing values generated)
(25,656 missing values generated)
(25,656 missing values generated)
(25,657 missing values generated)
(25,656 missing values generated)
(25,656 missing values generated)
(25,656 missing values generated)
(26,488 real changes made, 26,488 to missing)
(26,823 missing values generated)
(26,823 missing values generated)
(26,823 missing values generated)
(26,823 missing values generated)
(26,823 missing values generated)
(26,823 missing values generated)
(26,823 missing values generated)
(26,823 missing values generated)
(26,824 missing values generated)
(26,823 missing values generated)
(26,824 missing values generated)
(26,823 missing values generated)
(26,823 missing values generated)
(0 real changes made)
(26,823 missing values generated)
(0 real changes made)
(26,823 missing values generated)
(0 real changes made)
(26,823 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(27,069 missing values generated)
(27,824 real changes made, 27,824 to missing)
(28,167 missing values generated)
(28,167 missing values generated)
(28,167 missing values generated)
(28,167 missing values generated)
(28,167 missing values generated)
(28,167 missing values generated)
(28,167 missing values generated)
(28,167 missing values generated)
(28,167 missing values generated)
(28,167 missing values generated)
(28,167 missing values generated)
(28,167 missing values generated)
(28,167 missing values generated)
(0 real changes made)
(28,167 missing values generated)
(0 real changes made)
(28,167 missing values generated)
(0 real changes made)
(28,167 missing values generated)
(25,105 missing values generated)
(25,105 missing values generated)
(25,105 missing values generated)
(25,105 missing values generated)
(25,105 missing values generated)
(25,105 missing values generated)
(25,105 missing values generated)
(25,113 missing values generated)
(25,105 missing values generated)
(25,105 missing values generated)
(25,105 missing values generated)
(26,004 real changes made, 26,004 to missing)
(26,359 missing values generated)
(26,359 missing values generated)
(26,359 missing values generated)
(26,359 missing values generated)
(26,359 missing values generated)
(26,359 missing values generated)
(26,359 missing values generated)
(26,359 missing values generated)
(26,365 missing values generated)
(26,359 missing values generated)
(26,365 missing values generated)
(26,359 missing values generated)
(26,359 missing values generated)
(0 real changes made)
(26,359 missing values generated)
(0 real changes made)
(26,359 missing values generated)
(0 real changes made)
(26,359 missing values generated)
(26,765 missing values generated)
(26,765 missing values generated)
(26,765 missing values generated)
(26,765 missing values generated)
(26,765 missing values generated)
(26,765 missing values generated)
(26,765 missing values generated)
(26,769 missing values generated)
(26,765 missing values generated)
(26,765 missing values generated)
(26,765 missing values generated)
(27,555 real changes made, 27,555 to missing)
(27,895 missing values generated)
(27,895 missing values generated)
(27,895 missing values generated)
(27,895 missing values generated)
(27,895 missing values generated)
(27,895 missing values generated)
(27,895 missing values generated)
(27,895 missing values generated)
(27,898 missing values generated)
(27,895 missing values generated)
(27,898 missing values generated)
(27,895 missing values generated)
(27,895 missing values generated)
(0 real changes made)
(27,895 missing values generated)
(0 real changes made)
(27,895 missing values generated)
(0 real changes made)
(27,895 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(28,017 missing values generated)
(28,778 real changes made, 28,778 to missing)
(29,116 missing values generated)
(29,116 missing values generated)
(29,116 missing values generated)
(29,116 missing values generated)
(29,116 missing values generated)
(29,116 missing values generated)
(29,116 missing values generated)
(29,116 missing values generated)
(29,116 missing values generated)
(29,116 missing values generated)
(29,116 missing values generated)
(29,116 missing values generated)
(29,116 missing values generated)
(0 real changes made)
(29,116 missing values generated)
(0 real changes made)
(29,116 missing values generated)
(0 real changes made)
(29,116 missing values generated)
(23,200 missing values generated)
(23,200 missing values generated)
(23,200 missing values generated)
(23,200 missing values generated)
(23,200 missing values generated)
(23,201 missing values generated)
(23,200 missing values generated)
(23,206 missing values generated)
(23,200 missing values generated)
(23,200 missing values generated)
(23,200 missing values generated)
(24,722 real changes made, 24,722 to missing)
(25,174 missing values generated)
(25,174 missing values generated)
(25,174 missing values generated)
(25,174 missing values generated)
(25,174 missing values generated)
(25,175 missing values generated)
(25,174 missing values generated)
(25,174 missing values generated)
(25,179 missing values generated)
(25,174 missing values generated)
(25,179 missing values generated)
(25,174 missing values generated)
(25,174 missing values generated)
(0 real changes made)
(25,174 missing values generated)
(0 real changes made)
(25,174 missing values generated)
(0 real changes made)
(25,174 missing values generated)
(24,681 missing values generated)
(24,680 missing values generated)
(24,680 missing values generated)
(24,680 missing values generated)
(24,680 missing values generated)
(24,680 missing values generated)
(24,680 missing values generated)
(24,682 missing values generated)
(24,680 missing values generated)
(24,680 missing values generated)
(24,680 missing values generated)
(26,131 real changes made, 26,131 to missing)
(26,554 missing values generated)
(26,553 missing values generated)
(26,554 missing values generated)
(26,553 missing values generated)
(26,553 missing values generated)
(26,553 missing values generated)
(26,553 missing values generated)
(26,553 missing values generated)
(26,554 missing values generated)
(26,553 missing values generated)
(26,554 missing values generated)
(26,553 missing values generated)
(26,553 missing values generated)
(0 real changes made)
(26,553 missing values generated)
(0 real changes made)
(26,553 missing values generated)
(0 real changes made)
(26,553 missing values generated)
(26,487 missing values generated)
(26,488 missing values generated)
(26,487 missing values generated)
(26,487 missing values generated)
(26,487 missing values generated)
(26,488 missing values generated)
(26,487 missing values generated)
(26,488 missing values generated)
(26,487 missing values generated)
(26,487 missing values generated)
(26,487 missing values generated)
(27,791 real changes made, 27,791 to missing)
(28,155 missing values generated)
(28,156 missing values generated)
(28,156 missing values generated)
(28,155 missing values generated)
(28,155 missing values generated)
(28,156 missing values generated)
(28,155 missing values generated)
(28,155 missing values generated)
(28,156 missing values generated)
(28,155 missing values generated)
(28,156 missing values generated)
(28,155 missing values generated)
(28,155 missing values generated)
(0 real changes made)
(28,155 missing values generated)
(0 real changes made)
(28,155 missing values generated)
(0 real changes made)
(28,155 missing values generated)
(24,322 missing values generated)
(24,322 missing values generated)
(24,322 missing values generated)
(24,322 missing values generated)
(24,322 missing values generated)
(24,322 missing values generated)
(24,322 missing values generated)
(24,326 missing values generated)
(24,322 missing values generated)
(24,322 missing values generated)
(24,322 missing values generated)
(26,130 real changes made, 26,130 to missing)
(26,613 missing values generated)
(26,613 missing values generated)
(26,613 missing values generated)
(26,613 missing values generated)
(26,613 missing values generated)
(26,613 missing values generated)
(26,613 missing values generated)
(26,613 missing values generated)
(26,617 missing values generated)
(26,613 missing values generated)
(26,617 missing values generated)
(26,613 missing values generated)
(26,613 missing values generated)
(0 real changes made)
(26,613 missing values generated)
(0 real changes made)
(26,613 missing values generated)
(0 real changes made)
(26,615 missing values generated)
(28,088 missing values generated)
(28,088 missing values generated)
(28,088 missing values generated)
(28,088 missing values generated)
(28,088 missing values generated)
(28,088 missing values generated)
(28,088 missing values generated)
(28,091 missing values generated)
(28,088 missing values generated)
(28,088 missing values generated)
(28,088 missing values generated)
(29,598 real changes made, 29,598 to missing)
(29,966 missing values generated)
(29,966 missing values generated)
(29,966 missing values generated)
(29,966 missing values generated)
(29,966 missing values generated)
(29,966 missing values generated)
(29,966 missing values generated)
(29,966 missing values generated)
(29,969 missing values generated)
(29,966 missing values generated)
(29,969 missing values generated)
(29,966 missing values generated)
(29,966 missing values generated)
(0 real changes made)
(29,966 missing values generated)
(0 real changes made)
(29,966 missing values generated)
(0 real changes made)
(29,967 missing values generated)
(29,511 missing values generated)
(29,511 missing values generated)
(29,511 missing values generated)
(29,511 missing values generated)
(29,511 missing values generated)
(29,511 missing values generated)
(29,511 missing values generated)
(29,512 missing values generated)
(29,511 missing values generated)
(29,511 missing values generated)
(29,511 missing values generated)
(30,840 real changes made, 30,840 to missing)
(31,127 missing values generated)
(31,127 missing values generated)
(31,127 missing values generated)
(31,127 missing values generated)
(31,127 missing values generated)
(31,127 missing values generated)
(31,127 missing values generated)
(31,127 missing values generated)
(31,127 missing values generated)
(31,127 missing values generated)
(31,127 missing values generated)
(31,127 missing values generated)
(31,127 missing values generated)
(0 real changes made)
(31,127 missing values generated)
(0 real changes made)
(31,127 missing values generated)
(0 real changes made)
(31,127 missing values generated)
(29,378 missing values generated)
(29,378 missing values generated)
(29,378 missing values generated)
(29,378 missing values generated)
(29,378 missing values generated)
(29,378 missing values generated)
(29,378 missing values generated)
(29,384 missing values generated)
(29,378 missing values generated)
(29,378 missing values generated)
(29,378 missing values generated)
(30,767 real changes made, 30,767 to missing)
(31,089 missing values generated)
(31,089 missing values generated)
(31,089 missing values generated)
(31,089 missing values generated)
(31,089 missing values generated)
(31,089 missing values generated)
(31,089 missing values generated)
(31,089 missing values generated)
(31,093 missing values generated)
(31,089 missing values generated)
(31,093 missing values generated)
(31,089 missing values generated)
(31,089 missing values generated)
(0 real changes made)
(31,089 missing values generated)
(0 real changes made)
(31,089 missing values generated)
(0 real changes made)
(31,091 missing values generated)

. 
. * Reduce dataset to relevant variables
. capture unab _retvars : r1_annual_* r2_annual_* r3_annual_* r4_annual_* r5_annu
> al_* r1_annual_avg r2_annual_avg r3_annual_avg r4_annual_avg r5_annual_avg

. capture unab _wealthvars : wealth_total_* gross_wealth_* wealth_decile_* wealth
> _d*_* wealth_core_* wealth_ira_* wealth_coreira_* wealth_res_*

. capture unab _sharevars : share_pri_res_* share_sec_res_* share_res_* share_re_
> * share_bus_* share_ira_* share_stk_* share_bond_* share_chck_* share_other_* s
> hare_core_* share_fin_* share_debt_long_* share_debt_other_* share_debt_amort_*
>  share_debt_ahmln_*

. capture unab _incvars : labor_income_* total_income_*

. capture unab _ctrlvars : age_* inlbrf_* married_* censreg_* hometown_size_* tow
> nsize_trust_* pop_trust_* regional_trust_* region_pop_group_* ///
>     population_3bin_2020 pop3_trust_* townsize3_trust_* region_pop3_group_*

. local keepvars hhidpn gender educ_yrs immigrant born_us race_eth ///
>     trust_others_2020 trust_social_security_2020 trust_medicare_2020 trust_bank
> s_2020 ///
>     trust_advisors_2020 trust_mutual_funds_2020 trust_insurance_2020 trust_medi
> a_2020 ///
>     interest_2020 inflation_2020 risk_div_2020 par_citizen_2020 par_loyalty_202
> 0 population_2020 population_3bin_2020 ///
>     depression_2020 health_cond_2020 medicare_2020 medicaid_2020 life_ins_2020 
> beq_any_2020 ///
>     num_divorce_2020 num_widow_2020 ///
>     `_ctrlvars' `_agebinvars' `_retvars' `_wealthvars' `_sharevars' `_incvars'

. keep `keepvars'

. 
. save "${PROCESSED}/analysis_ready.dta", replace
file /Volumes/SSD
    PRO/Github-forks/Chp2-TrustandReturns/Code/Processing/analysis_ready.dta
    saved

. display "03_prep_controls: Saved ${PROCESSED}/analysis_ready.dta (N = " _N ")"
03_prep_controls: Saved /Volumes/SSD PRO/Github-forks/Chp2-TrustandReturns/Code/P
> rocessing/analysis_ready.dta (N = 45234)

. log close
      name:  <unnamed>
       log:  /Volumes/SSD PRO/Github-forks/Chp2-TrustandReturns/Notes/Logs/03_pre
> p_controls.log
  log type:  text
 closed on:  19 Feb 2026, 13:47:59
---------------------------------------------------------------------------------
